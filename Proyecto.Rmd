---
title: "Proyecto"
author: ""
date: '2022-06-14'
output: html_document
---

```{r}
library(tidyverse)
library(here)
library(readxl)
datos <- read_xlsx(here("Datos","Datos_base_ganadera.xlsx"))
```

Esta encuesta se trata de un muestreo cuya base muestral fue el censo general agropecuario del 2011 que tenía 25566 explotaciones ganaderas. Luego se realizó un muestreo por estrato de tamaño y por un criterio geografico. El tamaño de la muestra resultó ser de 1506 casos de los cuales algunos fueron descartados(porque ya no eran ganaderos o por otros aspectos) por lo que la muestra final es de 1426.
En este trabajo se propone una descripción de los resultados de la encuesta sin expandir a traves de ponderadores por lo que los resultados a los que arribemos solo serán validos para estos casos y no serán conclusiones que se puedan extender al conjunto de los productores ganaderos.



Fijarse cuantas son personas fisicas debido a que esas seran las que vamos a centrar el analisis con las caracteristicas demograficas para intentar encontrar patrones en relacion a la incorporacion de I+D

Elegir alguna variable de I+D y comparar para cada tipo de ganado vacuno, lo mismo con lo de los profesionales

Separar por los que si tienen I+D y los que no, y fijarse si contrataron profesional

Sumar todas las variables de innovación y usarla como una sola

ver razas predominantes para ovinos y bovinos para ovinos ver cantidad de lana y cantidad de cabezas vendidas ovinas

```{r}
datos %>% 
  group_by(a9) %>% 
  ggplot(aes(x=factor(a9)))+
  geom_bar()+
  labs(y="Cantidad")+
  scale_x_discrete(name="Condición jurídica",labels = c(
                                                       '1' = 'Persona física',
                                                       '2' = 'Sociedad sin contrato',
                                                       '3' = 'Sociedad con contrato legal',
                                                       '4' = 'Otra'))
```


```{r}
aiv_nueva <- datos %>% 
  mutate(aiv_1 = ifelse(aiv_1 == "2", 0, aiv_1)) %>% 
  mutate(aiv_2 = ifelse(aiv_2 == "2", 0, aiv_2)) %>% 
  mutate(aiv_3 = ifelse(aiv_3 == "2", 0, aiv_3)) %>% 
  mutate(aiv_4 = ifelse(aiv_4 == "2", 0, aiv_4)) %>% 
  mutate(aiv_5 = ifelse(aiv_5 == "2", 0, aiv_5)) %>% 
  mutate(aiv_6 = ifelse(aiv_6 == "2", 0, aiv_6)) %>% 
  mutate(aiv_7 = ifelse(aiv_7 == "2", 0, aiv_7)) %>% 
  mutate(aiv_8 = ifelse(aiv_8 == "2", 0, aiv_8))

aiv_nueva = rowSums(aiv_nueva[ , c("aiv_1","aiv_2","aiv_3","aiv_4","aiv_5","aiv_6","aiv_7","aiv_8")])

datos<-cbind(datos,aiv_nueva)

datos %>% 
  select(aiv_nueva) %>% 
  arrange(desc(aiv_nueva))


```


```{r}
datos %>% 
  group_by(a9,aiv_nueva,a12) %>% 
  filter(a9=="1",a12!="0") %>% 
  summarise(n=n()) %>%
  mutate(freq=n/sum(n)) %>%
  ggplot(aes(x=factor(aiv_nueva),y=freq,fill=factor(a12)))+
  geom_bar(stat="identity",position = "dodge")+
  scale_fill_brewer(name="Nivel educativo",palette="Paired",labels = c(
                                                       '1' = 'Ninguna',
                                                       '2' = 'Primaria',
                                                       '3' = 'Secundaria básica',
                                                       '4' = 'Secundaria superior',
                                                       '5' = 'Técnica',
                                                       '6' = 'Universitaria',
                                                       '7' = 'Otros'))

```


```{r}
datos %>% 
  group_by(a9,aiv_nueva) %>% 
  filter(a9=="1",a12!="0") %>% 
  ggplot(aes(x=factor(aiv_nueva)))+
  geom_bar()+
  labs(y="Cantidad")
```

```{r}
datos %>% 
  group_by(a9,aiv_nueva,prof_1) %>% 
  filter(a9=="1",prof_1!="0") %>% 
  summarise(n=n()) %>%
  mutate(freq=n/sum(n)) %>%
  ggplot(aes(x=factor(aiv_nueva),y=freq,fill=factor(prof_1)))+
  geom_bar(position = "dodge",stat="identity")+
  scale_fill_brewer(name="Personal Profesional",palette="Paired",labels = c(
                                                       '1' = 'Si',
                                                       '2' = 'No'))
```

